{
  "name": "08 - Discord New Tool Notifier",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "notify-new-tool",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [240, 300],
      "webhookId": "notify-new-tool"
    },
    {
      "parameters": {
        "jsCode": "const typeEmoji = {\n  skill: 'ğŸ“„', plugin: 'ğŸ”Œ', collection: 'ğŸ“¦', cli_tool: 'âŒ¨ï¸',\n  mcp_server: 'ğŸ”—', prompt_pack: 'ğŸ“', workflow: 'ğŸ”„',\n  extension: 'ğŸ§©', resource: 'ğŸ“š'\n};\nconst riskColor = {low: 0x00FF00, medium: 0xFFFF00, high: 0xFF0000, critical: 0x000000};\n\nconst t = $json;\nconst embed = {\n  title: `${typeEmoji[t.tool_type] || 'ğŸ“„'} New Tool: ${t.name}`,\n  description: t.description || 'No description',\n  url: t.repo_url,\n  color: riskColor[t.risk_level] || 0x5865F2,\n  fields: [\n    {name: 'ğŸ“Š Type', value: (t.tool_type || 'unknown').replace('_', ' '), inline: true},\n    {name: 'â­ Stars', value: String(t.stars || 0), inline: true},\n    {name: 'âš ï¸ Risk', value: t.risk_level || 'low', inline: true}\n  ],\n  footer: {text: 'ğŸ§  Skill of Skills', icon_url: 'https://github.com/911fund.png'},\n  timestamp: new Date().toISOString()\n};\n\n// Add install command based on type\nif (t.tool_type === 'skill' || t.tool_type === 'collection') {\n  embed.fields.push({name: 'ğŸ“¥ Install', value: '```npx add-skill ' + t.repo_owner + '/' + t.repo_name + '```', inline: false});\n} else if (t.tool_type === 'cli_tool') {\n  embed.fields.push({name: 'ğŸ“¥ Install', value: '```npm install -g ' + t.repo_name + '```', inline: false});\n}\n\nreturn [{json: {embeds: [embed]}}];"
      },
      "id": "build-embed",
      "name": "Build Embed",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [460, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{$env.DISCORD_WEBHOOK_URL}}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {"name": "Content-Type", "value": "application/json"}
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"username\": \"Skill of Skills\",\n  \"avatar_url\": \"https://github.com/911fund.png\",\n  \"embeds\": {{ JSON.stringify($json.embeds) }}\n}",
        "options": {}
      },
      "id": "send-discord",
      "name": "Send to Discord",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\"success\": true}"
      },
      "id": "respond",
      "name": "Respond",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [900, 300]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [[{"node": "Build Embed", "type": "main", "index": 0}]]
    },
    "Build Embed": {
      "main": [[{"node": "Send to Discord", "type": "main", "index": 0}]]
    },
    "Send to Discord": {
      "main": [[{"node": "Respond", "type": "main", "index": 0}]]
    }
  },
  "settings": {
    "executionOrder": "v1"
  }
}
