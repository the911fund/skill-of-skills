{
  "project": "Skill of Skills",
  "branchName": "compound/fix-trending-query-fallback",
  "description": "Add fallback logic to trending tools query to display top starred tools when no trending data exists",
  "tasks": [
    {
      "id": "T-001",
      "title": "Locate trending tools query in codebase",
      "description": "Search for files containing trending tools query logic, specifically looking for database queries that filter by trendingScore",
      "acceptanceCriteria": [
        "Search codebase for 'trendingScore' - find file(s) containing the query",
        "Search codebase for 'trending' and 'tools' - identify query location",
        "Log file path(s) containing trending query to notes",
        "File exists and is readable"
      ],
      "priority": 1,
      "passes": true,
      "notes": "FOUND: web/src/lib/queries/tools.ts (getTrendingTools function, lines 78-104) and web/src/app/api/v1/tools/trending/route.ts (API endpoint). Currently has a fallback to compositeScore but PRD requires fallback to GitHub stars instead."
    },
    {
      "id": "T-002",
      "title": "Locate homepage rendering code",
      "description": "Find the frontend or API endpoint code that renders trending tools on the homepage",
      "acceptanceCriteria": [
        "Search for homepage file (likely index, home, or main page component)",
        "Identify where trending tools results are rendered",
        "Log file path and function/component name to notes",
        "Confirm this connects to the trending query from T-001"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-003",
      "title": "Document current query logic",
      "description": "Read and analyze the current trending query implementation to understand its structure and thresholds",
      "acceptanceCriteria": [
        "Read the query file identified in T-001",
        "Log current query SQL/ORM code to notes",
        "Log any WHERE clauses or trendingScore filters to notes",
        "Log LIMIT value (should be 6 tools) to notes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-004",
      "title": "Verify database schema has github_stars column",
      "description": "Check that the database schema includes github_stars field needed for fallback query",
      "acceptanceCriteria": [
        "Search codebase for database schema or model definitions",
        "Confirm github_stars column exists in skills/tools table",
        "Log table name and column type to notes",
        "No schema changes required (verify only)"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-005",
      "title": "Add empty result detection logic",
      "description": "Modify the trending query function to check if results are empty (no tools with trendingScore > 0)",
      "acceptanceCriteria": [
        "Add conditional check after trending query executes",
        "Check if results.length === 0 OR all trendingScore <= 0",
        "Add comment explaining empty detection logic",
        "Run `npm run typecheck` - exits with code 0 (if TypeScript project)"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-006",
      "title": "Implement fallback query by GitHub stars",
      "description": "Add fallback query that fetches top tools sorted by github_stars DESC when trending results are empty",
      "acceptanceCriteria": [
        "Add fallback query with ORDER BY github_stars DESC",
        "Set LIMIT to match trending query limit (6 tools)",
        "Execute fallback only when trending results are empty",
        "Add comment explaining fallback query purpose"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-007",
      "title": "Ensure fallback returns results to same variable",
      "description": "Make sure both trending and fallback queries return data in the same format and variable for seamless rendering",
      "acceptanceCriteria": [
        "Both queries return to same variable/response object",
        "Data structure is identical for both query types",
        "No additional frontend changes required",
        "Run `npm run typecheck` - exits with code 0 (if TypeScript project)"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-008",
      "title": "Add logging for fallback activation",
      "description": "Add console/server logs to indicate when fallback query is used for debugging purposes",
      "acceptanceCriteria": [
        "Log message when trending query returns empty results",
        "Log message when fallback query executes",
        "Logs include number of tools returned",
        "Code compiles without errors"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-009",
      "title": "Start local development server",
      "description": "Start the web UI development server on port 3001 for browser testing",
      "acceptanceCriteria": [
        "Run development server start command",
        "Server starts successfully on port 3001",
        "No startup errors in console",
        "Server logs confirm it's running and ready"
      ],
      "priority": 9,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-010",
      "title": "Test homepage with current database state",
      "description": "Open homepage in browser to see current behavior with actual database data",
      "acceptanceCriteria": [
        "Navigate to http://localhost:3001 - page loads successfully",
        "Homepage displays tools section (trending or fallback)",
        "Count number of tools visible - log to notes",
        "Screenshot saved to tmp/homepage-before.png"
      ],
      "priority": 10,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-011",
      "title": "Check browser console for errors",
      "description": "Verify no JavaScript errors appear in browser console on homepage",
      "acceptanceCriteria": [
        "Open browser developer tools console",
        "Reload homepage at http://localhost:3001",
        "Log any console errors to notes (or 'none' if clean)",
        "No red error messages in console"
      ],
      "priority": 11,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-012",
      "title": "Verify fallback query activates with test data",
      "description": "Test that fallback query executes when trending data is unavailable (may require temporarily setting all trendingScores to 0 or checking server logs)",
      "acceptanceCriteria": [
        "Check server logs for fallback activation message",
        "If no trending tools exist, verify fallback query ran",
        "Homepage shows exactly 6 tools (or configured limit)",
        "Log which query type activated to notes"
      ],
      "priority": 12,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-013",
      "title": "Verify tools are sorted by stars in fallback",
      "description": "Confirm that when fallback query runs, tools appear in descending order by GitHub stars",
      "acceptanceCriteria": [
        "View tools on homepage",
        "Record first 3 tools' GitHub star counts to notes",
        "Verify stars are in descending order (highest first)",
        "All tools have visible GitHub star counts"
      ],
      "priority": 13,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-014",
      "title": "Test UI renders correctly with fallback data",
      "description": "Verify homepage UI displays fallback tools without visual issues or broken elements",
      "acceptanceCriteria": [
        "All tool cards render properly (no missing images/text)",
        "Layout matches existing design",
        "No broken UI elements or alignment issues",
        "Screenshot saved to tmp/homepage-fallback.png"
      ],
      "priority": 14,
      "passes": false,
      "notes": ""
    },
    {
      "id": "T-015",
      "title": "Run type checking and linting",
      "description": "Ensure all code changes pass TypeScript type checking and linting rules",
      "acceptanceCriteria": [
        "Run `npm run typecheck` (or equivalent) - exits with code 0",
        "Run `npm run lint` (or equivalent) - exits with code 0 or only warnings",
        "No new TypeScript errors introduced",
        "No critical linting errors"
      ],
      "priority": 15,
      "passes": false,
      "notes": ""
    }
  ]
}
