# Compound Product Progress Log
Started: Sun Feb  1 00:08:56 MST 2026
---

## Codebase Patterns
- Trending query located in web/src/lib/queries/tools.ts (getTrendingTools function)
- Database schema uses Prisma ORM defined in web/prisma/schema.prisma
- GitHub stars stored in `stars` field (not github_stars) in Tool model
- API endpoints follow pattern: web/src/app/api/v1/{resource}/{action}/route.ts
- Current fallback uses compositeScore instead of stars (PRD requires stars)
- Testing framework: Vitest with happy-dom environment, tests placed alongside source files with .test.ts suffix
- Quality checks: npm run lint and npm run build must both pass before committing

---

## 2026-02-01 00:10 - T-001
- Located trending tools query in codebase
- Files identified:
  - web/src/lib/queries/tools.ts - contains getTrendingTools() function (lines 78-104)
  - web/src/app/api/v1/tools/trending/route.ts - API endpoint that exposes trending tools
- **Learnings for future iterations:**
  - Existing code already has fallback mechanism (lines 90-101 in tools.ts)
  - Current fallback uses `compositeScore DESC` ordering
  - PRD requirement is to use `stars DESC` (GitHub stars) instead
  - Database field is named `stars` not `github_stars` in schema
  - Query uses Prisma ORM with prisma.tool.findMany()
---

## 2026-02-01 00:12 - T-002
- Located homepage rendering code
- Homepage file: web/src/app/page.tsx
- Currently displays "Recently Added" section (lines 71-79), NOT trending tools
- getTrendingTools() function exists but not used on homepage
- README generation API (web/src/app/api/v1/readme/route.ts) shows same issue - displays "*No trending tools yet*" when no trending data
- **Learnings for future iterations:**
  - Homepage uses `getTools({ sort: 'recent' }, 1, 6)` for recent tools
  - The main task is to fix the fallback in getTrendingTools() to use stars instead of compositeScore
  - No need to add trending section to homepage - just fix the fallback logic
---

## 2026-02-01 00:14 - T-003
- Documented current query logic from web/src/lib/queries/tools.ts
- Primary query (lines 79-88):
  - WHERE: isActive=true, validationStatus IN ['passed','skipped'], trendingScore > 0
  - ORDER BY: trendingScore DESC
  - LIMIT: parameterized (default 10, README API uses 6)
- Fallback query (lines 91-100):
  - WHERE: same as primary but NO trendingScore filter
  - ORDER BY: compositeScore DESC (THIS NEEDS TO CHANGE TO stars DESC)
  - LIMIT: same as primary
- **Learnings for future iterations:**
  - Empty detection already exists (line 91: if tools.length === 0)
  - Only need to change orderBy from compositeScore to stars in fallback
---

## 2026-02-01 01:17 - T-001
- Located web UI codebase and tool card component
- Files identified:
  - Web UI directory: web/src
  - Tool card component: web/src/components/tools/ToolCard.tsx (receives Tool type as prop)
  - TypeScript types: web/src/types/index.ts
  - Database schema: web/prisma/schema.prisma
- Added lastCommitAt field to Tool interface in web/src/types/index.ts
- **Learnings for future iterations:**
  - Database field is named `lastCommitAt` (not `lastCommitDate`) in schema.prisma line 95
  - Project uses Prisma ORM for database access
  - No dedicated typecheck script - use `npm run build` which includes type checking
  - ToolCard component receives full Tool object, so has access to all Tool properties including lastCommitAt
  - Tool type interface must stay in sync with Prisma schema
---
## 2026-02-01 01:25 - T-002
- Created maintenance status utility function file
- Files created:
  - web/src/utils/maintenanceStatus.ts
- Implementation details:
  - Function: getMaintenanceStatus(lastCommitDate: Date | string | null)
  - Returns: { status: MaintenanceStatus, color: string }
  - Thresholds: Active <30d, Maintained 30-90d, Stale 90-180d, Inactive >180d
  - Colors: Active (green #22c55e), Maintained (yellow #eab308), Stale (orange #f97316), Inactive (red #ef4444), Unknown (gray #6b7280)
  - Handles null/undefined input and invalid dates gracefully
- **Learnings for future iterations:**
  - TypeScript strict typing required for all exports
  - Date calculations use Math.floor for consistent day counting
  - String dates converted using new Date() constructor
  - Invalid dates detected with isNaN(date.getTime())
  - Build includes both linting and type checking (npm run build)
---
## 2026-02-01 00:35 - T-003
- Added unit tests for maintenance status calculation edge cases
- Files created/modified:
  - Created web/vitest.config.ts - Vitest configuration with happy-dom environment
  - Created web/src/utils/maintenanceStatus.test.ts - 17 comprehensive test cases
  - Modified web/package.json - Added test and test:watch scripts
  - Created web/.eslintrc.json - ESLint configuration for Next.js
  - Fixed web/src/components/search/SearchResults.tsx - Pre-existing ESLint error (unescaped quotes)
- Test coverage:
  - Active status: 15d, 1d, 29d boundary tests
  - Maintained status: 60d, 30d boundary, 89d boundary tests
  - Stale status: 120d, 90d boundary, 179d boundary tests
  - Inactive status: 200d, 180d boundary, 365d tests
  - Unknown status: null, undefined, invalid date string tests
  - String date input: ISO string handling tests
- All 17 tests pass with exit code 0
- **Learnings for future iterations:**
  - Project did not have testing framework set up initially
  - Vitest is a good choice for Next.js/React projects (fast, modern)
  - Use happy-dom for lightweight DOM environment in tests
  - Helper function pattern (daysAgo) makes date testing clean and readable
  - Boundary testing is critical for threshold-based logic
  - Pre-existing lint errors should be fixed to pass quality checks
  - npm run lint requires .eslintrc.json configuration file
  - Quality checks (lint + build) both pass after changes
---
## 2026-02-01 00:45 - T-004
- Created maintenance status badge component
- Files created:
  - web/src/components/tools/MaintenanceBadge.tsx (35 lines)
- Implementation details:
  - Component accepts status: MaintenanceStatus prop
  - Maps status to Badge variants: Active (success), Maintained (warning), Stale (warning), Inactive (danger), Unknown (default)
  - Includes emoji icons: ðŸŸ¢ Active, ðŸŸ¡ Maintained, ðŸŸ  Stale, ðŸ”´ Inactive, âšª Unknown
  - Uses aria-label for accessibility support
- Quality checks: Both npm run lint and npm run build pass with exit code 0
- **Learnings for future iterations:**
  - Badge components follow consistent pattern in web/src/components/tools/
  - Use existing Badge UI component from @/components/ui/Badge
  - Map custom states to Badge variants (success, warning, danger, default)
  - Include emoji icons for visual clarity (follow RiskBadge.tsx pattern)
  - Use aria-label on icon spans for screen reader accessibility
  - Stale status uses 'warning' variant (same as Maintained) but different emoji
---
## 2026-02-01 01:35 - T-005
- Added hover tooltips to MaintenanceBadge component
- Files modified:
  - web/src/components/tools/MaintenanceBadge.tsx
- Implementation details:
  - Wrapped Badge component in a span with title attribute for native browser tooltips
  - Created tooltips mapping with explanatory text for all 5 status levels
  - Tooltip format: "[Status]: [Description] ([Time threshold])"
  - Examples: "Active: Updated within the last 30 days", "Maintained: Updated within the last 90 days (30-90 days ago)"
- Quality checks: Both npm run lint and npm run build pass with exit code 0
- **Learnings for future iterations:**
  - Native HTML title attribute provides simple, accessible tooltip without requiring additional dependencies
  - Wrapping components in span with title preserves all styling and functionality
  - Tooltip text should be descriptive and include specific time thresholds for clarity
  - No tooltip component library exists in this project - prefer native solutions
---
## 2026-02-01 01:45 - T-006
- Integrated MaintenanceBadge component into ToolCard
- Files modified:
  - web/src/components/tools/ToolCard.tsx
- Implementation details:
  - Imported MaintenanceBadge component from './MaintenanceBadge'
  - Imported getMaintenanceStatus utility function from '@/utils/maintenanceStatus'
  - Added maintenance status calculation using getMaintenanceStatus(tool.lastCommitAt)
  - Badge positioned in left badge group (after TypeBadge, before Official/Verified badges)
  - Badge appears in top-left area of card alongside other status indicators
- Quality checks: Both npm run lint and npm run build pass with exit code 0
- **Learnings for future iterations:**
  - Badge components should be placed with other status badges for visual consistency
  - Calculate status values once in component body to avoid repeated computation
  - Position new badges based on their importance and relationship to existing badges
  - Tool cards have a two-section badge layout: left (status badges) and right (risk badge)
  - The lastCommitAt field from Tool type can be passed directly to getMaintenanceStatus
---
